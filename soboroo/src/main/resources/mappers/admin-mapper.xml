<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "mybatis-3-mapper.dtd" >

<mapper namespace="adminMapper">
	
	<resultMap type="AdminNotice" id="adminResultSet">
		<result column = "ntc_no" property="ntcNo"/>
		<result column = "ntc_writer" property="ntcWriter"/>
		<result column = "ntc_title" property="ntcTitle"/>
		<result column = "ntc_content" property="ntcContent"/>
		<result column = "ntc_create_date" property="ntcCreateDate"/>
		<result column = "ntc_update_date" property="ntcUpdateDate"/>
		<result column = "ntc_count" property="ntcCount"/>
		<result column = "ntc_del_ny" property="ntcDelNy"/>
	</resultMap>
	
	<resultMap type="AdminBoard" id="adminResultSet2">
		<result column = "board_no" property = "boardNo"/>
		<result column = "board_title" property = "boardTitle"/>
		<result column = "board_content" property = "boardContent"/>
		<result column = "create_date" property = "createDate"/>
		<result column = "modify_date" property = "modifyDate"/>
		<result column = "count" property = "count"/>
		<result column = "rep_ny" property = "repNy"/>
		<result column = "del_ny" property = "delNy"/>
		<result column = "category" property = "category"/>
		<result column = "mem_no" property = "memNo"/>
		<result column = "table_no" property = "tableNo"/>
	</resultMap>
	
	<resultMap type="AdminMember" id="adminMemResultSet">
		<result column="mem_no" property="memNo"/>
		<result column="mem_token" property="memToken"/>
		<result column="mem_id" property="memId"/>
		<result column="mem_birth" property="memBirth"/>
		<result column="mem_phone" property="memPhone"/>
		<result column="mem_name" property="memName"/>
		<result column="mem_status" property="memStatus"/>
		<result column="mem_nickname" property="memNickname"/>
		<result column="mem_introduce" property="memIntroduce"/>
		<result column="mem_rpr_count" property="memRprCount"/>
		<result column="mem_img" property="memImg"/>
		<result column="mem_enroll_date" property="memEnrollDate"/>
		<result column="mem_update_date" property="memUpdateDate"/>
	</resultMap>
	
	<resultMap type="AdminCategory" id="adminCategoryResultSet">
			<result column="category_no" property="categoryNo"/>
			<result column="category_title" property="categoryTitle"/>
	</resultMap>
	
	<resultMap type="AdminReply" id="adminReplyResultSet">
		<result column="reply_no" property="replyNo"/>
		<result column="reply_content" property="replyContent"/>
		<result column="enroll_date" property="enrollDate"/>
		<result column="modify_date" property="modifyDate"/>
		<result column="del_ny" property="delNy"/>
		<result column="rep_ny" property="repNy"/>
		<result column="recomment_ny" property="recommentNy"/>
		<result column="reper_no" property="reperNo"/>
		<result column="group_board_no" property="groupBoardNo"/>
		<result column="mem_no" property="memNo"/>
		<result column="table_no" property="tableNo"/>
	</resultMap>
	
	
	<select id="selectNoticeListCount" resultType="_int">
		select    
	    count(*)
	    from notice
	    where ntc_del_ny = 'N'
	</select>	
	
	<select id="selectNoticeList" resultMap="adminResultSet">
		select 
		  ntc_no
		, ntc_writer
		, ntc_title
		, ntc_content
		, to_char(ntc_create_date, 'YYYY-MM-DD') as "ntc_create_date"
		, ntc_update_date
		, ntc_count
		, ntc_del_ny
	from notice 
	where ntc_del_ny = 'N'
	order
	by ntc_no desc

	</select>
	
	<select id="selectBoardListCount" resultType="_int">
		select    
		    count(*) as "count"
		    from board
		    where del_ny = 'N'
	</select>	
	
	
	<select id="selectBoardList" resultMap="adminResultSet2">
		select
		    board_no
		  , board_title
		  , board_content
		  , to_char(create_date, 'YYYY-MM-DD') as "create_date"
		  , modify_date
		  , count
		  , del_ny
		  , mem_no
		  , table_no
		  , category_title
		  , mem_name
	   from board
	   join category on (board.category = category.category_no)
	   join member using(mem_no)
	  where del_ny = 'N'
	  order
		 by board_no desc
	</select>
	
	<select id="selectMemberList" resultMap="adminMemResultSet">
		select
		      mem_no
		    , mem_token
		    , mem_id
		    , to_char(mem_birth, 'YYYY-MM-DD') as "mem_birth"
		    , mem_phone
		    , mem_name
		    , mem_status
		    , mem_nickname
		    , mem_introduce
		    , mem_rpr_count
		    , mem_img
		    , mem_enroll_date
		    , mem_update_date
      from member

	</select>
	
	
	<select id="selectSusMemberList" resultMap="adminMemResultSet">
			select 
	        mem_name
	     ,  mem_id
	     ,  mem_rpr_count
	     ,  to_char(mem_update_date,'YYYY-MM-DD')
	     ,  to_char(mem_update_date + 7 ,'YYYY-MM-DD') as mem_suspension_date
	     ,  mem_status
     from member 
	where mem_status = 3
	
	
	</select>
	
	
	<select id="selectReportList" resultMap="adminMemResultSet">
		select 
        mem_nickname
      , mem_id
      , mem_rpr_count
      , board_title
      , board_content
      , reply_content
      , to_char(create_date,'YYYY-MM-DD')
      , to_char(enroll_date, 'YYYY-MM-DD')
      , sysdate
      , mem_id as "report_id"
     from member
     join board using(mem_no)
     join reply using(mem_no)
     where mem_rpr_count != 0
	
	</select>
	
	
	
	

</mapper>