<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "mybatis-3-mapper.dtd" >

<mapper namespace="boardMapper">

	<resultMap type="Board" id="boardResultSet">
		<result column = "board_no" property = "boardNo"/>
		<result column = "board_title" property = "boardTitle"/>
		<result column = "board_content" property = "boardContent"/>
		<result column = "create_date" property = "createDate"/>
		<result column = "modify_date" property = "modifyDate"/>
		<result column = "count" property = "count"/>
		<result column = "rep_ny" property = "repNy"/>
		<result column = "del_ny" property = "delNy"/>
		<result column = "category" property = "category"/>
		<result column = "mem_no" property = "memNo"/>
		<result column = "table_no" property = "tableNo"/>
	</resultMap>
		
	<select id="selectBoardListCount" resultType="_int">
		select    
		    count(*) as "count"
		    from board
		    where del_ny = 'N'
		      and rep_ny = 'N'
	</select>	
	
	<select id="selectBoardList" resultMap="boardResultSet">
		select
		    board_no
		  , board_title
		  , board_content
		  , to_char(create_date, 'YYYY-MM-DD') as "create_date"
		  , modify_date
		  , count
		  , del_ny
		  , category
		  , mem_no
		  , table_no
	   from board
	  where del_ny = 'N'
	    and rep_ny = 'N'
	  order
		 by board_no desc
	</select>
	
	<update id="increaseCount">
		update
				board
		   set count = count + 1
		 where board_no = #{boardNo}
		   and del_ny = 'N'
		   and rep_ny = 'N'
	</update>
	
	<select id="selectBoard" resultMap="boardResultSet">
		select
			   board_no
			 , category
			 , board_title
			 , to_char(create_date, 'YYYY-MM-DD') as "create_date"
			 , board_content
			 , count
		 	 , table_no
		  from board
		 where board_no = #{boardNo}
	</select>
	
	<select id="selectListCount" resultType="_int">
		select
				count(*)
		   from board
		  where del_ny='N'
		    and rep_ny = 'N' 	
		    and mem_no = #{memNo}	
		    
	</select>

	<select id="selectList" resultMap="boardResultSet">
	   SELECT 
      b.board_no,
      b.board_title,
      b.count,
      to_char(b.create_date, 'YYYY-MM-DD') as "create_date"
    FROM board b
    JOIN member m
      ON b.mem_no = m.mem_no
    WHERE b.del_ny = 'N'
      and b.rep_ny = 'N'
      AND m.mem_no = #{memNo}
    ORDER BY b.board_no DESC
	</select>
	


</mapper>