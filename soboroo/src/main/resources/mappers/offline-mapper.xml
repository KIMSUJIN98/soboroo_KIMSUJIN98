<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "mybatis-3-mapper.dtd" >
 <mapper namespace="offlineMapper">
	<resultMap id="offlineGroupOnceResultSet" type="OfflineGroupOnce">
		<result column="NO" property="no"/>
		<result column="TITLE" property="title"/>
		<result column="ID" property="id"/>
		<result column="NAME" property="name"/>
		<result column="EMAIL" property="email"/>
		<result column="PHONE" property="phone"/>
		<result column="SIMPLE" property="simple"/>
		<result column="ENROLL_DATE" property="enrollDate"/>
		<result column="MODIFY_DATE" property="modifyDate"/>
		<result column="START_DATE" property="startDate"/>
		<result column="END_DATE" property="endDate"/>
		<result column="START_ENTER" property="startEnter"/>
		<result column="END_ENTER" property="endEnter"/>
		<result column="CONTENT" property="content"/>
		<result column="ADDRESS" property="address"/>
		<result column="ADDRESS_DETAIL" property="addressDetail"/>
		<result column="DISPLAY_NY" property="displayNY"/>
		<result column="EVENT_PASSWORD" property="eventPassword"/>
		<result column="HASH_TAG" property="hashTag"/>
		<result column="DEL_NY" property="delNY"/>
		<result column="REP_NY" property="repNY"/>
		<result column="URL" property="url"/>
		<result column="MAX" property="max"/>
		<result column="MAX_ACCESS" property="maxAccess"/>
		<result column="ADULT_ACCESS" property="adultAccess"/>
		<result column="CATEGORY_NO" property="category"/>
		<result column="CATEGORY_TITLE" property="categoryTitle"/>
		<result column="MEM_NO" property="memNo"/>
		<result column="TABLE_NO" property="tableNo"/>
		<result column="ATTEND_PASSWORD" property="attendPassword"/>
		<result column="MEM_EMAIL" property="memEmail"/>
		<result column="MEM_IMG" property="memImg"/>
		<result column="MEM_NICKNAME" property="memNickname"/>
	</resultMap>
	
	<resultMap id="uploadResultset" type="Upload">
		<result column="UPLOAD_NO" property="uploadNo"/>
		<result column="ORIGIN_NAME" property="originName"/>
		<result column="CHANGE_NAME" property="changeName"/>
		<result column="GROUP_BOARD_NO" property="groupBoardNo"/>
		<result column="TABLE_NO" property="tableNo"/>
	</resultMap>
	
	<resultMap id="entryListResultset" type="EntryList">
		<result column="GROUP_NO" property="groupNo"/>
		<result column="GROUP_TITLE" property="groupTitle"/>
		<result column="ENTRY_ID" property="entryId"/>
		<result column="WAIT_NY" property="waitNY"/>
		<result column="START_DATE" property="startDate"/>
		<result column="END_DATE" property="endDate"/>
		<result column="MEM_NO" property="memNo"/>
		<result column="TABLE_NO" property="tableNo"/>
	</resultMap>
	
	<select id="selectListCount" resultType="_int">
		select 
		       count(*)
		  from OFFLINE_GROUP_ONCE
		 where status = 'Y'
	</select>
	
	<select id="selectList" resultMap="offlineGroupOnceResultSet">
		select
		       NO
		     , TITLE
		     , ID
		     , NAME
		     , EMAIL
		     , PHONE
		     , SIMPLE
		     , START_DATE
		     , END_DATE
		     , START_ENTER
		     , END_ENTER
		     , CONTENT
		     , ADDRESS
		     , ADDRESS_DETAIL
		     , DISPLAY_NY
			 , EVENT_PASSWORD
			 , HASH_TAG
			 , URL
			 , MAX
			 , MAX_ACCESS
			 , ADULT_ACCESS
			 , CATEGORY_NO
			 , MEM_NO
			 , TABLE_NO
			 , ATTEND_PASSWORD
			 , COUNT
             , category_title
             , mem_email
             , mem_img
             , mem_nickname
		  from OFFLINE_GROUP_ONCE
          join category using(category_no)
          join member using(mem_no)
		  where status = 'Y'
		 order
		    by NO desc
	</select>
	
	<update id="increaseCount">
		update
		       OFFLINE_GROUP_ONCE
		   set count = count + 1
		 where no = #{no}
		   and status = 'Y'
	</update>
	
	<select id="selectGroupOne" resultMap="offlineGroupOnceResultSet">
		select 
		       NO
		     , TITLE
		     , ID
		     , NAME
		     , EMAIL
		     , PHONE
		     , SIMPLE
		     , START_DATE
		     , END_DATE
		     , START_ENTER
		     , END_ENTER
		     , CONTENT
		     , ADDRESS
		     , ADDRESS_DETAIL
		     , DISPLAY_NY
			 , EVENT_PASSWORD
			 , HASH_TAG
			 , URL
			 , MAX
			 , MAX_ACCESS
			 , ADULT_ACCESS
			 , CATEGORY_TITLE
			 , MEM_NO
			 , TABLE_NO
			 , ATTEND_PASSWORD
			 , COUNT
		  from OFFLINE_GROUP_ONCE
          JOIN CATEGORY USING (CATEGORY_NO)
		 where no = ${no}
	</select>
	
	<insert id="insertGroupOne">
		INSERT
		  INTO OFFLINE_GROUP_ONCE
		     (
		       NO
		     , TITLE
		     , ID
		     , NAME
		     , EMAIL
		     , PHONE
		     , SIMPLE
		     , START_DATE
		     , END_DATE
		     , START_ENTER
		     , END_ENTER
		     , CONTENT
		     , ADDRESS
		     , ADDRESS_DETAIL
		     , DISPLAY_NY
			 , EVENT_PASSWORD
			 , HASH_TAG
			 , URL
			 , MAX
			 , MAX_ACCESS
			 , ADULT_ACCESS
			 , CATEGORY_NO
			 , MEM_NO
			 , TABLE_NO
			 , ATTEND_PASSWORD
		     )
		VALUES
		     (
		       SEQ_ON_GROUP_ONCE_NO.NEXTVAL
		     , #{title}
		     , #{id}
		     , #{name}
		     , #{email}
		     , #{phone}
		     , #{simple}
		     , #{startDate}
		     , #{endDate}
		     , #{startEnter}
		     , #{endEnter}
		     , #{content}
		     , #{address}
		     , #{addressDetail}
		     , #{displayNY}
		     , #{eventPassword}
		     , #{hashTag}
		     , #{url}
		     , #{max}
		     , #{maxAccess}
		     , #{adultAccess}
		     , #{category}
		     , #{memNo}
		     , #{tableNo}
		     , #{attendPassword}
		     )
	</insert>
	
	<insert id="insertEntryListSelf">
		INSERT
		  INTO ENTRY_LIST
		     (
		       GROUP_NO
		     , GROUP_TITLE
		     , ENTRY_ID
		     , START_DATE
		     , END_DATE
		     , MEM_NO
		     , TABLE_NO
		     )
		VALUES
		     (
		       SEQ_ON_GROUP_ONCE_NO.CURRVAL
		     , #{title}
		     , #{id}
		     , #{startDate}
		     , #{endDate}
		     , #{memNo}
		     , #{tableNo}
		     )
	
	</insert>
	
	
	
	
	
	
	
	
	
	
	
</mapper>